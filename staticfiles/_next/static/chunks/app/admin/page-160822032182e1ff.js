(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{1238:function(e,t,r){Promise.resolve().then(r.bind(r,991))},991:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return V}});var a=r(7437),d=r(2265),s=r(9376),i=r(7926),n=r(1699),l=r(9345),o=r(1713),c=r(521),x=r(3405);let m=async e=>(await x.x.get("/api/kiosk/admin/reports/sales/",{params:e})).data,u=async e=>(await x.x.get("/api/kiosk/admin/reports/products/",{params:e})).data,p=async e=>(await x.x.get("/api/kiosk/admin/reports/stock/",{params:e})).data,g=async e=>(await x.x.get("/api/kiosk/admin/reports/daily/",{params:e})).data;var h=r(9693),b=r(6196),k=r(839),y=r.n(k),v=r(8614);function j(e){let t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?(console.error("Invalid date:",e),""):new(y())(t).format("YYYY/MM/DD HH:mm:ss")}function f(){return function(e){let t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?(console.error("Invalid date:",e),""):new(y())(t).format("YYYY/MM/DD")}(new Date)}function N(e){if(!e||"string"!=typeof e||""===e.trim())return"";let t=e.trim();if(!/^\d{4}\/\d{2}\/\d{2}$/.test(t))return console.error("Invalid Jalali date format:",e),"";try{let[r,a,d]=t.split("/").map(Number);if(!r||!a||!d||r<1300||r>1500||a<1||a>12||d<1||d>31)return console.error("Invalid Jalali date values:",{year:r,month:a,day:d}),"";let s=new(y())([r,a-1,d]).toDate();if(isNaN(s.getTime()))return console.error("Invalid date conversion:",e),"";let i=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),l=String(s.getDate()).padStart(2,"0"),o="".concat(i,"-").concat(n,"-").concat(l);if(i<1900||i>2100)return console.error("Invalid date conversion result:",o,"from:",e),"";return o}catch(t){return console.error("Error converting date:",t,"input:",e),""}}let w=(0,d.forwardRef)((e,t)=>{let{label:r,value:s,onChange:i,onBlur:n,name:l,error:o,placeholder:x="تاریخ را انتخاب کنید"}=e,[m,u]=(0,d.useState)(!1),p=(0,d.useRef)(null),g=()=>{if(s)try{let[e,t,r]=s.split("/").map(Number);if(e&&t&&r)return{year:e,month:t-1,day:r}}catch(e){}let e=new(y());return{year:e.year(),month:e.month(),day:e.date()}},[h,k]=(0,d.useState)(()=>{let e=new(y());return{year:e.year(),month:e.month(),day:e.date()}});(0,d.useEffect)(()=>{!s&&i&&i({target:{value:f()}})},[]),(0,d.useEffect)(()=>{if(s){let e=g();e.year&&void 0!==e.month&&e.month>=0&&e.day&&k(e)}else{let e=new(y());k({year:e.year(),month:e.month(),day:e.date()})}},[s]),(0,d.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&u(!1)};return m&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[m]);let j=(e,t,r)=>{let a="".concat(e,"/").concat(String(t+1).padStart(2,"0"),"/").concat(String(r).padStart(2,"0"));i&&i({target:{value:a}}),u(!1)},N=new(y()),w=N.year(),_=N.month(),S=N.date(),C=(null==h?void 0:h.year)||w,z=(null==h?void 0:h.month)!==void 0?h.month:_,q=z<6?31:z<11?30:C%4==3?30:29,F=((e,t)=>{let r=new Date(2e3,0,1);return new(y())(r),(new Date(e+621,t,1).getDay()+1)%7})(C,z),A=[];for(let e=0;e<F;e++)A.push({year:0,month:0,day:0});for(let e=1;e<=q;e++)A.push({year:C,month:z,day:e});let E=e=>{let t=C,r=z;"prev"===e?0===r?(r=11,t--):r--:11===r?(r=0,t++):r++,k({year:t,month:r,day:1})};return(0,a.jsxs)("div",{className:"relative",ref:p,children:[(0,a.jsx)("div",{onClick:()=>u(!m),children:(0,a.jsx)(b.I,{ref:t,label:r,type:"text",value:s||"",onChange:i,onBlur:n,name:l,placeholder:x,error:o,readOnly:!0})}),(0,a.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 mt-4 pointer-events-none",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-text-secondary dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,a.jsx)(v.M,{children:m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>u(!1)}),(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-20 mt-2 w-80 bg-card dark:bg-card-dark border border-border dark:border-border-dark rounded-lg shadow-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),E("prev")},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"font-bold text-text dark:text-text-dark",children:[["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"][z]," ",C]})}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),E("next")},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["ش","ی","د","س","چ","پ","ج"].map(e=>(0,a.jsx)("div",{className:"text-center text-xs font-bold text-text-secondary dark:text-gray-400 py-2",children:e},e))}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1",children:A.map((e,t)=>{if(0===e.day)return(0,a.jsx)("div",{className:"aspect-square"},t);let r=e.year===w&&e.month===_&&e.day===S,d=s&&s==="".concat(e.year,"/").concat(String(e.month+1).padStart(2,"0"),"/").concat(String(e.day).padStart(2,"0"));return(0,a.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),j(e.year,e.month,e.day)},className:"aspect-square rounded-lg text-sm transition-colors ".concat(d?"bg-primary text-white font-bold":r?"bg-primary/20 text-primary font-bold":"hover:bg-gray-100 dark:hover:bg-gray-800 text-text dark:text-text-dark"),children:e.day},t)})}),(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-border dark:border-border-dark",children:(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),j(w,_,S)},className:"w-full py-2 text-sm text-primary hover:bg-primary/10 rounded-lg transition-colors",children:"امروز"})})]})]})})]})});w.displayName="DatePicker";var _=r(4508);function S(){var e,t,r,s,i,n,x,b,k,y;let[v,S]=(0,d.useState)("sales"),[C,z]=(0,d.useState)(""),[q,F]=(0,d.useState)(""),[A,E]=(0,d.useState)(f()),[L,M]=(0,d.useState)(1),[I,T]=(0,d.useState)(1),[D,R]=(0,d.useState)(1),[P,O]=(0,d.useState)(1),[K]=(0,d.useState)(20),{data:B,isLoading:Y}=(0,o.a)({queryKey:["sales-report",C,q,L,K],queryFn:()=>m({start_date:N(C)||void 0,end_date:N(q)||void 0,page:L,page_size:K}),enabled:"sales"===v,staleTime:0,gcTime:0,refetchOnMount:!0}),{data:U,isLoading:W}=(0,o.a)({queryKey:["products-report",I,K],queryFn:()=>u({page:I,page_size:K}),enabled:"products"===v,staleTime:0,gcTime:0,refetchOnMount:!0}),{data:Q,isLoading:J}=(0,o.a)({queryKey:["stock-report",D,K],queryFn:()=>p({page:D,page_size:K}),enabled:"stock"===v,staleTime:0,gcTime:0,refetchOnMount:!0}),{data:H,isLoading:V}=(0,o.a)({queryKey:["daily-report",A,P,K],queryFn:()=>g({date:N(A)||void 0,page:P,page_size:K}),enabled:"daily"===v,staleTime:0,gcTime:0,refetchOnMount:!0}),Z=e=>{S(e),M(1),T(1),R(1),O(1)},X=(e,t,r,d)=>{if(!r&&!d||r&&r<=K)return null;let s=r?Math.ceil(r/K):d?e+1:e;return s<=1?null:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-6",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>t(Math.max(1,e-1)),disabled:1===e,children:"قبلی"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,s)},(r,d)=>{let i;return i=s<=5?d+1:e<=3?d+1:e>=s-2?s-4+d:e-2+d,(0,a.jsx)(l.z,{variant:e===i?"primary":"outline",size:"sm",onClick:()=>t(i),className:"min-w-[40px]",children:i},i)})}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>t(Math.min(s,e+1)),disabled:e===s,children:"بعدی"})]})},$=e=>e?({pending:"در انتظار",processing:"در حال پردازش",paid:"پرداخت شده",completed:"تکمیل شده",cancelled:"لغو شده"})[e.toLowerCase()]||e:"نامشخص",G=e=>e?({pending:"در انتظار",processing:"در حال پردازش",success:"موفق",paid:"پرداخت شده",failed:"ناموفق",cancelled:"لغو شده"})[e.toLowerCase()]||e:"نامشخص",ee=async e=>{try{await h.k.reprintReceipt(e),console.log("Receipt reprinted successfully for order:",e)}catch(e){console.error("Error reprinting receipt:",e)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h2",{className:"text-2xl font-bold text-text dark:text-text-dark",children:"گزارشات"})}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(l.z,{variant:"sales"===v?"primary":"outline",size:"sm",onClick:()=>Z("sales"),children:"گزارش فروش"}),(0,a.jsx)(l.z,{variant:"products"===v?"primary":"outline",size:"sm",onClick:()=>Z("products"),children:"گزارش محصولات"}),(0,a.jsx)(l.z,{variant:"stock"===v?"primary":"outline",size:"sm",onClick:()=>Z("stock"),children:"گزارش موجودی"}),(0,a.jsx)(l.z,{variant:"daily"===v?"primary":"outline",size:"sm",onClick:()=>Z("daily"),children:"گزارش روزانه"})]})}),"sales"===v&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,a.jsx)(w,{label:"از تاریخ",value:C,onChange:e=>{z(e.target.value),M(1)}}),(0,a.jsx)(w,{label:"تا تاریخ",value:q,onChange:e=>{F(e.target.value),M(1)}})]}),"daily"===v&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(w,{label:"تاریخ",value:A,onChange:e=>{E(e.target.value),O(1)}})})]}),Y||W||J||V?(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-8 border border-border dark:border-border-dark text-center",children:(0,a.jsx)("p",{className:"text-text-secondary dark:text-gray-400",children:"در حال بارگذاری..."})}):(0,a.jsxs)(a.Fragment,{children:["sales"===v&&(null==B?void 0:B.result)&&(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"مجموع فروش"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.x)((null===(e=B.result.summary)||void 0===e?void 0:e.total_sales)||0)})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"تعداد سفارشات"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.u)((null===(t=B.result.summary)||void 0===t?void 0:t.total_orders)||0)})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"میانگین ارزش سفارش"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.x)((null===(r=B.result.summary)||void 0===r?void 0:r.average_order_value)||0)})]})]}),B.result.results&&B.result.results.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl border border-border dark:border-border-dark overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"شماره سفارش"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"مبلغ"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"وضعیت"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"تاریخ"}),(0,a.jsx)("th",{className:"px-6 py-4 text-center text-sm font-bold text-text dark:text-text-dark",children:"عملیات"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border dark:divide-border-dark",children:B.result.results.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.order_number}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.x)(e.total_amount)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat("paid"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"pending"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"cancelled"===e.status?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"),children:$(e.status)})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:j(e.created_at)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:"paid"===e.status||"paid"===e.payment_status?(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>ee(e.order_number),className:"text-xs",children:"چاپ مجدد"}):(0,a.jsx)("span",{className:"text-lg text-text-secondary dark:text-gray-400",children:"-"})})})]},e.id))})]})})}),X(L,M,B.result.count,!!B.result.next)]})]}),"products"===v&&(null==U?void 0:U.result)&&(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"کل محصولات"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.u)((null===(s=U.result.summary)||void 0===s?void 0:s.total_products)||0)})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"محصولات فعال"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:(0,_.u)((null===(i=U.result.summary)||void 0===i?void 0:i.active_products)||0)})]})]}),U.result.results&&U.result.results.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl border border-border dark:border-border-dark overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"نام محصول"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"دسته‌بندی"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"قیمت"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"موجودی"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"تعداد فروخته شده"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"درآمد کل"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border dark:divide-border-dark",children:U.result.results.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.name}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.category_name}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.x)(e.price)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.u)(e.stock_quantity)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.u)(e.total_sold)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.x)(e.total_revenue)})]},e.id))})]})})}),X(I,T,U.result.count,!!U.result.next)]})]}),"stock"===v&&(null==Q?void 0:Q.result)&&(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"ارزش کل موجودی"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.x)((null===(n=Q.result.summary)||void 0===n?void 0:n.total_stock_value)||0)})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"تعداد کل آیتم‌ها"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.u)((null===(x=Q.result.summary)||void 0===x?void 0:x.total_items)||0)})]})]}),Q.result.results&&Q.result.results.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl border border-border dark:border-border-dark overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"نام محصول"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"موجودی"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"قیمت"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"ارزش موجودی"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"وضعیت"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border dark:divide-border-dark",children:Q.result.results.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.name}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.u)(e.stock_quantity)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.x)(e.price)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.x)(e.stock_value)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm",children:e.is_out_of_stock?(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:"تمام شده"}):e.is_low_stock?(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:"کم موجودی"}):(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"موجود"})})]},e.id))})]})})}),X(D,R,Q.result.count,!!Q.result.next)]})]}),"daily"===v&&(null==H?void 0:H.result)&&(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"مجموع فروش"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.x)((null===(b=H.result.summary)||void 0===b?void 0:b.total_sales)||0)})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"تعداد سفارشات"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.u)((null===(k=H.result.summary)||void 0===k?void 0:k.total_orders)||0)})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 mb-2",children:"تعداد تراکنش‌ها"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-text dark:text-text-dark",children:(0,_.u)((null===(y=H.result.summary)||void 0===y?void 0:y.total_transactions)||0)})]})]}),H.result.results&&H.result.results.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl border border-border dark:border-border-dark overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"شماره سفارش"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"مبلغ"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"وضعیت"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"تاریخ"}),(0,a.jsx)("th",{className:"px-6 py-4 text-center text-sm font-bold text-text dark:text-text-dark",children:"عملیات"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border dark:divide-border-dark",children:H.result.results.map((e,t)=>{let r=e.status||e.payment_status;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.order_number}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:(0,_.x)(e.total_amount)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat("paid"===r?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"pending"===r?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"cancelled"===r?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"),children:G(r)})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:j(e.created_at)}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:"paid"===r||"paid"===e.payment_status?(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>ee(e.order_number),className:"text-xs",children:"چاپ مجدد"}):(0,a.jsx)("span",{className:"text-lg text-text-secondary dark:text-gray-400",children:"-"})})})]},e.id||"order-".concat(t,"-").concat(e.order_number))})})]})})}),X(P,O,H.result.count,!!H.result.next)]})]})]})]})}var C=r(9827),z=r(1770);let q=async e=>(await x.x.get("/api/kiosk/admin/categories/",{params:e})).data,F=async e=>(await x.x.post("/api/kiosk/admin/categories/",e)).data,A=async(e,t)=>(await x.x.put("/api/kiosk/admin/categories/".concat(e,"/"),t)).data,E=async e=>{await x.x.delete("/api/kiosk/admin/categories/".concat(e,"/"))},L=async e=>(await x.x.get("/api/kiosk/admin/products/",{params:e})).data,M=async e=>{if(e instanceof FormData)return console.log("Using provided FormData for createProduct"),(await x.x.post("/api/kiosk/admin/products/",e,{headers:{"Content-Type":"multipart/form-data"}})).data;let t=new FormData;return t.append("name",e.name),e.description&&t.append("description",e.description),t.append("price",e.price.toString()),e.category&&t.append("category",e.category.toString()),e.image instanceof File&&(console.log("Appending image to FormData:",e.image.name,e.image.size),t.append("image",e.image)),void 0!==e.stock_quantity&&t.append("stock_quantity",e.stock_quantity.toString()),void 0!==e.is_active&&t.append("is_active",e.is_active.toString()),(await x.x.post("/api/kiosk/admin/products/",t,{headers:{"Content-Type":"multipart/form-data"}})).data},I=async(e,t)=>{if(t instanceof FormData)return(await x.x.patch("/api/kiosk/admin/products/".concat(e,"/"),t,{headers:{"Content-Type":"multipart/form-data"}})).data;let r=new FormData;return t.name&&r.append("name",t.name),t.description&&r.append("description",t.description),void 0!==t.price&&r.append("price",t.price.toString()),t.category&&r.append("category",t.category.toString()),t.image instanceof File&&(console.log("Appending image to FormData:",t.image.name,t.image.size),r.append("image",t.image)),void 0!==t.stock_quantity&&r.append("stock_quantity",t.stock_quantity.toString()),void 0!==t.is_active&&r.append("is_active",t.is_active.toString()),(await x.x.patch("/api/kiosk/admin/products/".concat(e,"/"),r,{headers:{"Content-Type":"multipart/form-data"}})).data},T=async e=>{await x.x.delete("/api/kiosk/admin/products/".concat(e,"/"))};var D=r(9501),R=r(3590),P=r(7119);function O(e){let{categories:t,value:r,onChange:s,placeholder:i="انتخاب دسته‌بندی",error:n,label:l="دسته‌بندی",excludeIds:o=[]}=e,[x,m]=(0,d.useState)(!1),[u,p]=(0,d.useState)(""),g=(0,d.useRef)(null),h=(0,d.useRef)(null),b=t.find(e=>e.id===r),k=t.filter(e=>{let t=e.name.toLowerCase().includes(u.toLowerCase()),r=!o.includes(e.id);return t&&r});(0,d.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&(m(!1),p(""))};return x&&(document.addEventListener("mousedown",e),setTimeout(()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.focus()},0)),()=>{document.removeEventListener("mousedown",e)}},[x]);let y=e=>{s(e),m(!1),p("")};return(0,a.jsxs)("div",{className:"relative",ref:g,children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-text dark:text-text-dark",children:l}),(0,a.jsxs)("button",{type:"button",onClick:()=>m(!x),className:"w-full px-4 py-3 rounded-lg border ".concat(n?"border-red-500 dark:border-red-500":"border-border dark:border-border-dark"," bg-card dark:bg-card-dark text-text dark:text-text-dark focus:outline-none focus:ring-2 focus:ring-primary flex items-center justify-between transition-colors hover:border-primary"),children:[(0,a.jsx)("span",{className:b?"":"text-text-secondary dark:text-gray-400",children:b?b.name:i}),(0,a.jsx)("svg",{className:"w-5 h-5 transition-transform ".concat(x?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:n}),(0,a.jsx)(v.M,{children:x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-10",onClick:()=>m(!1)}),(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-20 w-full mt-2 bg-card dark:bg-card-dark border border-border dark:border-border-dark rounded-lg shadow-lg max-h-64 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-2 border-b border-border dark:border-border-dark",children:(0,a.jsx)("input",{ref:h,type:"text",value:u,onChange:e=>p(e.target.value),placeholder:"جستجو...",className:"w-full px-3 py-2 rounded-lg border border-border dark:border-border-dark bg-background dark:bg-background-dark text-text dark:text-text-dark focus:outline-none focus:ring-2 focus:ring-primary",onClick:e=>e.stopPropagation()})}),(0,a.jsxs)("div",{className:"max-h-48 overflow-y-auto",children:[(0,a.jsx)("button",{type:"button",onClick:()=>y(null),className:"w-full text-right px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors ".concat(null===r?"bg-primary/10 dark:bg-primary/20 text-primary font-medium":"text-text dark:text-text-dark"),children:"بدون دسته‌بندی"}),k.length>0?k.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>y(e.id),className:"w-full text-right px-4 py-3 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors ".concat(r===e.id?"bg-primary/10 dark:bg-primary/20 text-primary font-medium":"text-text dark:text-text-dark"),children:e.name},e.id)):(0,a.jsx)("div",{className:"px-4 py-3 text-center text-text-secondary dark:text-gray-400",children:"دسته‌بندی یافت نشد"})]})]})]})})]})}let K=P.Ry({name:P.Z_().min(1,"نام الزامی است"),parent:P.Rx().nullable().optional(),display_order:P.Rx().optional(),is_active:P.O7().optional()});function B(e){var t,r,d;let{category:s,categories:i=[],onSubmit:n,onCancel:o,isLoading:c=!1}=e,{register:x,handleSubmit:m,control:u,formState:{errors:p}}=(0,D.cI)({resolver:(0,R.F)(K),defaultValues:{name:(null==s?void 0:s.name)||"",parent:(null==s?void 0:s.parent)||null,display_order:(null==s?void 0:s.display_order)||0,is_active:null===(d=null==s?void 0:s.is_active)||void 0===d||d}});return(0,a.jsxs)("form",{onSubmit:m(n),className:"space-y-6",children:[(0,a.jsx)("div",{children:(0,a.jsx)(b.I,{label:"نام دسته‌بندی",...x("name"),error:null===(t=p.name)||void 0===t?void 0:t.message,required:!0})}),(0,a.jsx)(D.Qr,{name:"parent",control:u,render:e=>{var t,r;let{field:d,fieldState:n}=e;return(0,a.jsx)(O,{categories:Array.isArray(i)?i:[],value:null!==(r=d.value)&&void 0!==r?r:null,onChange:d.onChange,placeholder:"بدون دسته والد",label:"دسته والد (اختیاری)",error:null===(t=n.error)||void 0===t?void 0:t.message,excludeIds:(null==s?void 0:s.id)?[s.id]:[]})}}),(0,a.jsx)("div",{children:(0,a.jsx)(b.I,{label:"ترتیب نمایش",type:"number",...x("display_order",{valueAsNumber:!0}),error:null===(r=p.display_order)||void 0===r?void 0:r.message})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"is_active",...x("is_active"),className:"w-5 h-5 rounded border-border dark:border-border-dark text-primary focus:ring-primary"}),(0,a.jsx)("label",{htmlFor:"is_active",className:"text-sm font-medium text-text dark:text-text-dark",children:"فعال"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(l.z,{type:"submit",variant:"primary",isLoading:c,children:s?"ذخیره تغییرات":"ایجاد دسته‌بندی"}),(0,a.jsx)(l.z,{type:"button",variant:"outline",onClick:o,children:"انصراف"})]})]})}function Y(){var e;let[t,r]=(0,d.useState)(!1),[s,i]=(0,d.useState)(null),[n,x]=(0,d.useState)(""),[m,u]=(0,d.useState)("-id"),[p,g]=(0,d.useState)(1),[h]=(0,d.useState)(20),k=(0,C.NL)(),{data:y,isLoading:v}=(0,o.a)({queryKey:["admin-categories",n,m,p,h],queryFn:()=>q({search:n||void 0,ordering:m,page:p,page_size:h})}),j=(0,z.D)({mutationFn:F,onSuccess:()=>{k.invalidateQueries({queryKey:["admin-categories"]}),r(!1),g(1)}}),f=(0,z.D)({mutationFn:e=>{let{id:t,data:r}=e;return A(t,r)},onSuccess:()=>{k.invalidateQueries({queryKey:["admin-categories"]}),i(null),r(!1)}}),N=(0,z.D)({mutationFn:E,onSuccess:()=>{k.invalidateQueries({queryKey:["admin-categories"]})}}),w=e=>{x(e),g(1)},_=e=>{u(e),g(1)},S=Array.isArray(null==y?void 0:y.result)?y.result:(null==y?void 0:null===(e=y.result)||void 0===e?void 0:e.results)||[],L=null==y?void 0:y.result,M=(null==L?void 0:L.count)||(Array.isArray(null==y?void 0:y.result)?y.result.length:S.length),I=M>0?Math.ceil(M/h):1,T=async e=>{s?await f.mutateAsync({id:s.id,data:e}):await j.mutateAsync(e)},D=e=>{i(e),r(!0)},R=async e=>{confirm("آیا مطمئن هستید که می‌خواهید این دسته‌بندی را حذف کنید؟")&&await N.mutateAsync(e)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-text dark:text-text-dark",children:"مدیریت دسته‌بندی‌ها"}),(0,a.jsx)(l.z,{variant:"primary",onClick:()=>{i(null),r(!0)},children:"+ افزودن دسته‌بندی"})]}),t&&(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-text dark:text-text-dark mb-6",children:s?"ویرایش دسته‌بندی":"ایجاد دسته‌بندی جدید"}),(0,a.jsx)(B,{category:s||void 0,categories:S,onSubmit:T,onCancel:()=>{r(!1),i(null)},isLoading:j.isPending||f.isPending})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(b.I,{type:"text",placeholder:"جستجو در دسته‌بندی‌ها...",value:n,onChange:e=>w(e.target.value),className:"w-full"})}),(0,a.jsx)("div",{className:"w-full md:w-64",children:(0,a.jsxs)("select",{value:m,onChange:e=>_(e.target.value),className:"w-full px-4 py-3 rounded-lg border border-border dark:border-border-dark bg-card dark:bg-card-dark text-text dark:text-text-dark focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,a.jsx)("option",{value:"-id",children:"جدیدترین"}),(0,a.jsx)("option",{value:"id",children:"قدیمی‌ترین"}),(0,a.jsx)("option",{value:"name",children:"نام (صعودی)"}),(0,a.jsx)("option",{value:"-name",children:"نام (نزولی)"}),(0,a.jsx)("option",{value:"display_order",children:"ترتیب نمایش (کم به زیاد)"}),(0,a.jsx)("option",{value:"-display_order",children:"ترتیب نمایش (زیاد به کم)"})]})})]}),M>0&&(0,a.jsxs)("div",{className:"mt-4 text-sm text-text-secondary dark:text-gray-400",children:["نمایش ",(p-1)*h+1," تا ",Math.min(p*h,M)," از ",M," دسته‌بندی"]})]}),v?(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-20 bg-gray-100 dark:bg-gray-800 rounded-lg animate-pulse"},t))}):0===S.length?(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-8 border border-border dark:border-border-dark text-center",children:(0,a.jsx)("p",{className:"text-text-secondary dark:text-gray-400",children:"هیچ دسته‌بندی‌ای وجود ندارد"})}):(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl border border-border dark:border-border-dark overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"نام"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"دسته والد"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"ترتیب نمایش"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"وضعیت"}),(0,a.jsx)("th",{className:"px-6 py-4 text-right text-sm font-bold text-text dark:text-text-dark",children:"عملیات"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border dark:divide-border-dark",children:S.map((e,t)=>{var r;return(0,a.jsxs)(c.E.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.name}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.parent&&(null===(r=S.find(t=>t.id===e.parent))||void 0===r?void 0:r.name)||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-text dark:text-text-dark",children:e.display_order||0}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(e.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:e.is_active?"فعال":"غیرفعال"})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>D(e),children:"ویرایش"}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>R(e.id),className:"text-red-600 hover:text-red-700",children:"حذف"})]})})]},e.id)})})]})})}),I>1&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-6",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===p,children:"قبلی"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,I)},(e,t)=>{let r;return r=I<=5?t+1:p<=3?t+1:p>=I-2?I-4+t:p-2+t,(0,a.jsx)(l.z,{variant:p===r?"primary":"outline",size:"sm",onClick:()=>g(r),className:"min-w-[40px]",children:r},r)})}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>g(e=>Math.min(I,e+1)),disabled:p===I,children:"بعدی"})]})]})}var U=r(3145);let W=P.Ry({name:P.Z_().min(1,"نام الزامی است"),description:P.Z_().optional(),price:P.Rx().min(0,"قیمت باید مثبت باشد"),category:P.Rx().nullable(),stock_quantity:P.Rx().min(0,"تعداد موجودی باید مثبت باشد").optional(),is_active:P.O7().optional(),image:P.Yj().optional()}).refine(e=>null!==e.category&&void 0!==e.category,{message:"دسته‌بندی الزامی است",path:["category"]});function Q(e){var t,r,s,i,n,o;let{product:c,categories:x=[],onSubmit:m,onCancel:u,isLoading:p=!1,apiErrors:g={}}=e,[h,k]=(0,d.useState)((null==c?void 0:c.image)||null),{register:y,handleSubmit:v,control:j,formState:{errors:f}}=(0,D.cI)({resolver:(0,R.F)(W),defaultValues:{name:(null==c?void 0:c.name)||"",description:(null==c?void 0:c.description)||"",price:(null==c?void 0:c.price)||0,category:(null==c?void 0:c.category)||null,stock_quantity:(null==c?void 0:c.stock_quantity)||0,is_active:null===(o=null==c?void 0:c.is_active)||void 0===o||o}}),N=async e=>{var t;let r=document.querySelector('input[type="file"]'),a=null==r?void 0:null===(t=r.files)||void 0===t?void 0:t[0];a?console.log("Image file selected:",a.name,a.size,a.type):(null==c?void 0:c.image)?console.log("Using existing image:",c.image):console.log("No image provided");let d={...e,image:a||void 0};await m(d)};return(0,a.jsxs)("form",{onSubmit:v(N),className:"space-y-6",children:[Object.keys(g).length>0&&(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-2",children:"خطاهای اعتبارسنجی:"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:Object.entries(g).map(e=>{let[t,r]=e;return(0,a.jsx)("li",{className:"text-sm text-red-700 dark:text-red-300",children:Array.isArray(r)?r.join(", "):r},t)})})]}),(0,a.jsx)("div",{children:(0,a.jsx)(b.I,{label:(0,a.jsxs)(a.Fragment,{children:["نام محصول ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),...y("name"),error:(null===(t=f.name)||void 0===t?void 0:t.message)||(null===(r=g.name)||void 0===r?void 0:r[0]),required:!0})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-text dark:text-text-dark",children:"توضیحات"}),(0,a.jsx)("textarea",{...y("description"),rows:4,className:"w-full px-4 py-3 rounded-lg border border-border dark:border-border-dark bg-card dark:bg-card-dark text-text dark:text-text-dark focus:outline-none focus:ring-2 focus:ring-primary resize-none"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{children:(0,a.jsx)(b.I,{label:(0,a.jsxs)(a.Fragment,{children:["قیمت (تومان) ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),type:"number",...y("price",{valueAsNumber:!0}),error:(null===(s=f.price)||void 0===s?void 0:s.message)||(null===(i=g.price)||void 0===i?void 0:i[0]),required:!0})}),(0,a.jsx)("div",{children:(0,a.jsx)(b.I,{label:"تعداد موجودی",type:"number",...y("stock_quantity",{valueAsNumber:!0}),error:null===(n=f.stock_quantity)||void 0===n?void 0:n.message})})]}),(0,a.jsx)(D.Qr,{name:"category",control:j,render:e=>{var t,r,d;let{field:s,fieldState:i}=e;return(0,a.jsx)(O,{categories:Array.isArray(x)?x:[],value:null!==(d=s.value)&&void 0!==d?d:null,onChange:s.onChange,error:(null===(t=i.error)||void 0===t?void 0:t.message)||(null===(r=g.category)||void 0===r?void 0:r[0]),label:(0,a.jsxs)(a.Fragment,{children:["دسته‌بندی ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]})})}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-text dark:text-text-dark",children:"تصویر محصول"}),(0,a.jsx)("input",{type:"file",accept:"image/*",...y("image"),onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){let e=new FileReader;e.onloadend=()=>{k(e.result)},e.readAsDataURL(r)}},className:"w-full px-4 py-3 rounded-lg border border-border dark:border-border-dark bg-card dark:bg-card-dark text-text dark:text-text-dark focus:outline-none focus:ring-2 focus:ring-primary"}),h&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("img",{src:h,alt:"Preview",className:"w-32 h-32 object-cover rounded-lg"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"is_active",...y("is_active"),className:"w-5 h-5 rounded border-border dark:border-border-dark text-primary focus:ring-primary"}),(0,a.jsx)("label",{htmlFor:"is_active",className:"text-sm font-medium text-text dark:text-text-dark",children:"فعال"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(l.z,{type:"submit",variant:"primary",isLoading:p,children:c?"ذخیره تغییرات":"ایجاد محصول"}),(0,a.jsx)(l.z,{type:"button",variant:"outline",onClick:u,children:"انصراف"})]})]})}function J(){var e,t;let[r,s]=(0,d.useState)(!1),[i,n]=(0,d.useState)(null),[x,m]=(0,d.useState)(""),[u,p]=(0,d.useState)("-id"),[g,h]=(0,d.useState)(1),[k]=(0,d.useState)(12),[y,v]=(0,d.useState)({}),j=(0,C.NL)(),{data:f,isLoading:N}=(0,o.a)({queryKey:["admin-products",x,u,g,k],queryFn:async()=>await L({search:x||void 0,ordering:u,page:g,page_size:k})}),{data:w}=(0,o.a)({queryKey:["admin-categories"],queryFn:()=>q()}),S=(0,z.D)({mutationFn:M,onSuccess:()=>{j.invalidateQueries({queryKey:["admin-products"]}),s(!1),h(1),v({})},onError:e=>{var t;let r=null===(t=e.response)||void 0===t?void 0:t.data;(null==r?void 0:r.messages)?v(r.messages):v({general:["خطا در ایجاد محصول. لطفا دوباره تلاش کنید."]})}}),F=(0,z.D)({mutationFn:e=>{let{id:t,data:r}=e;return I(t,r)},onSuccess:()=>{j.invalidateQueries({queryKey:["admin-products"]}),n(null),s(!1),v({})},onError:e=>{var t;let r=null===(t=e.response)||void 0===t?void 0:t.data;(null==r?void 0:r.messages)?v(r.messages):v({general:["خطا در به‌روزرسانی محصول. لطفا دوباره تلاش کنید."]})}}),A=(0,z.D)({mutationFn:T,onSuccess:()=>{j.invalidateQueries({queryKey:["admin-products"]})}}),E=e=>{m(e),h(1)},D=e=>{p(e),h(1)},R=(null==f?void 0:null===(e=f.result)||void 0===e?void 0:e.results)||(null==f?void 0:f.result)||[],P=Array.isArray(null==w?void 0:w.result)?w.result:(null==w?void 0:null===(t=w.result)||void 0===t?void 0:t.results)||[],O=null==f?void 0:f.result,K=(null==O?void 0:O.count)||(Array.isArray(null==f?void 0:f.result)?f.result.length:R.length),B=K>0?Math.ceil(K/k):1,Y=async e=>{let t=new FormData;e.name&&t.append("name",e.name),e.description&&t.append("description",e.description),void 0!==e.price&&t.append("price",e.price.toString()),e.category&&t.append("category",e.category.toString()),void 0!==e.stock_quantity&&t.append("stock_quantity",e.stock_quantity.toString()),void 0!==e.is_active&&t.append("is_active",e.is_active.toString()),e.image instanceof File?(console.log("Adding image to FormData:",e.image.name,e.image.size,e.image.type),t.append("image",e.image)):(null==i?void 0:i.image)&&!e.image?console.log("Keeping existing image:",i.image):console.log("No image to upload"),i?await F.mutateAsync({id:i.id,data:t}):await S.mutateAsync(t)},W=e=>{n(e),s(!0)},J=async e=>{confirm("آیا مطمئن هستید که می‌خواهید این محصول را حذف کنید؟")&&await A.mutateAsync(e)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-text dark:text-text-dark",children:"مدیریت محصولات"}),(0,a.jsx)(l.z,{variant:"primary",onClick:()=>{n(null),s(!0)},children:"+ افزودن محصول"})]}),r&&(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-text dark:text-text-dark mb-6",children:i?"ویرایش محصول":"ایجاد محصول جدید"}),(0,a.jsx)(Q,{product:i||void 0,categories:P,onSubmit:Y,onCancel:()=>{s(!1),n(null),v({})},isLoading:S.isPending||F.isPending,apiErrors:y})]}),(0,a.jsxs)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-6 border border-border dark:border-border-dark",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(b.I,{type:"text",placeholder:"جستجو در محصولات...",value:x,onChange:e=>E(e.target.value),className:"w-full"})}),(0,a.jsx)("div",{className:"w-full md:w-64",children:(0,a.jsxs)("select",{value:u,onChange:e=>D(e.target.value),className:"w-full px-4 py-3 rounded-lg border border-border dark:border-border-dark bg-card dark:bg-card-dark text-text dark:text-text-dark focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,a.jsx)("option",{value:"-id",children:"جدیدترین"}),(0,a.jsx)("option",{value:"id",children:"قدیمی‌ترین"}),(0,a.jsx)("option",{value:"name",children:"نام (صعودی)"}),(0,a.jsx)("option",{value:"-name",children:"نام (نزولی)"}),(0,a.jsx)("option",{value:"price",children:"قیمت (کم به زیاد)"}),(0,a.jsx)("option",{value:"-price",children:"قیمت (زیاد به کم)"}),(0,a.jsx)("option",{value:"stock_quantity",children:"موجودی (کم به زیاد)"}),(0,a.jsx)("option",{value:"-stock_quantity",children:"موجودی (زیاد به کم)"})]})})]}),K>0&&(0,a.jsxs)("div",{className:"mt-4 text-sm text-text-secondary dark:text-gray-400",children:["نمایش ",(g-1)*k+1," تا ",Math.min(g*k,K)," از ",K," محصول"]})]}),N?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>(0,a.jsx)("div",{className:"h-64 bg-gray-100 dark:bg-gray-800 rounded-lg animate-pulse"},t))}):0===R.length?(0,a.jsx)("div",{className:"bg-card dark:bg-card-dark rounded-2xl p-8 border border-border dark:border-border-dark text-center",children:(0,a.jsx)("p",{className:"text-text-secondary dark:text-gray-400",children:"هیچ محصولی وجود ندارد"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map((e,t)=>{var r,d;return(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-card dark:bg-card-dark rounded-2xl border border-border dark:border-border-dark overflow-hidden",children:[(0,a.jsx)("div",{className:"relative w-full h-48 bg-gray-100 dark:bg-gray-800",children:e.image?(0,a.jsx)(U.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",unoptimized:(null===(r=e.image)||void 0===r?void 0:r.startsWith("http://localhost"))||(null===(d=e.image)||void 0===d?void 0:d.startsWith("http://")),onError:e=>{e.currentTarget.style.display="none"}}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:"بدون تصویر"})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-text dark:text-text-dark mb-2",children:e.name}),(0,a.jsx)("div",{className:"h-[2.5rem] mb-4",children:e.description?(0,a.jsx)("p",{className:"text-sm text-text-secondary dark:text-gray-400 line-clamp-2",children:e.description}):null}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("span",{className:"text-xl font-bold text-primary dark:text-primary-light",children:(0,_.x)(e.price)}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat(e.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:e.is_active?"فعال":"غیرفعال"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>W(e),className:"flex-1",children:"ویرایش"}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>J(e.id),className:"flex-1 text-red-600 hover:text-red-700",children:"حذف"})]})]})]},e.id)})}),B>1&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-6",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>h(e=>Math.max(1,e-1)),disabled:1===g,children:"قبلی"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,B)},(e,t)=>{let r;return r=B<=5?t+1:g<=3?t+1:g>=B-2?B-4+t:g-2+t,(0,a.jsx)(l.z,{variant:g===r?"primary":"outline",size:"sm",onClick:()=>h(r),className:"min-w-[40px]",children:r},r)})}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>h(e=>Math.min(B,e+1)),disabled:g===B,children:"بعدی"})]})]})}function H(e){let{children:t,redirectTo:r="/admin/login"}=e,{accessToken:s}=(0,i.t)(),[n,l]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{l(!0)},[]),(0,d.useEffect)(()=>{if(!n)return;let e=setTimeout(()=>{if(!s){try{let t=localStorage.getItem("auth-storage");if(t){var e;let r=JSON.parse(t);if(null==r?void 0:null===(e=r.state)||void 0===e?void 0:e.accessToken)return}}catch(e){console.error("Error checking auth:",e)}window.location.replace(r)}},100);return()=>clearTimeout(e)},[n,s,r]),n)?(()=>{if(s)return!0;try{let t=localStorage.getItem("auth-storage");if(t){var e;let r=JSON.parse(t);return!!(null==r?void 0:null===(e=r.state)||void 0===e?void 0:e.accessToken)}}catch(e){}return!1})()?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background dark:bg-background-dark",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-text-secondary dark:text-gray-400",children:"در حال هدایت به صفحه ورود..."})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background dark:bg-background-dark",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-text-secondary dark:text-gray-400",children:"در حال بررسی دسترسی..."})]})})}function V(){(0,s.useRouter)();let{logout:e,user:t}=(0,i.t)(),[r,o]=(0,d.useState)("products");return(0,d.useEffect)(()=>{let e=()=>{sessionStorage.setItem("from-admin","true")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),(0,a.jsx)(H,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-background dark:bg-background-dark",children:[(0,a.jsx)("header",{className:"bg-card dark:bg-card-dark border-b border-border dark:border-border-dark sticky top-0 z-30",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-text dark:text-text-dark",children:"پنل مدیریت"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n.T,{}),(0,a.jsx)("div",{className:"text-sm text-text-secondary dark:text-gray-400",children:null==t?void 0:t.username}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>{sessionStorage.setItem("from-admin","true"),localStorage.removeItem("auth-storage"),e(),window.location.href="/"},children:"خروج"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center gap-8 border-b border-border dark:border-border-dark",children:[(0,a.jsx)("button",{type:"button",onClick:()=>o("products"),className:"pb-4 border-b-2 transition-colors ".concat("products"===r?"text-primary dark:text-primary-light border-primary font-bold":"text-text-secondary dark:text-gray-400 border-transparent hover:text-text dark:hover:text-text-dark hover:border-primary"),children:"محصولات"}),(0,a.jsx)("button",{type:"button",onClick:()=>o("categories"),className:"pb-4 border-b-2 transition-colors ".concat("categories"===r?"text-primary dark:text-primary-light border-primary font-bold":"text-text-secondary dark:text-gray-400 border-transparent hover:text-text dark:hover:text-text-dark hover:border-primary"),children:"دسته بندی"}),(0,a.jsx)("button",{type:"button",onClick:()=>o("reports"),className:"pb-4 border-b-2 transition-colors ".concat("reports"===r?"text-primary dark:text-primary-light border-primary font-bold":"text-text-secondary dark:text-gray-400 border-transparent hover:text-text dark:hover:text-text-dark hover:border-primary"),children:"گزارشات"})]})]})}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8",children:["products"===r&&(0,a.jsx)(J,{}),"categories"===r&&(0,a.jsx)(Y,{}),"reports"===r&&(0,a.jsx)(S,{})]})]})})}},9345:function(e,t,r){"use strict";r.d(t,{z:function(){return n}});var a=r(7437),d=r(2265),s=r(4508),i=r(521);let n=(0,d.forwardRef)((e,t)=>{let{className:r,variant:d="primary",size:n="md",isLoading:l=!1,disabled:o,children:c,...x}=e;return(0,a.jsx)(i.E.button,{ref:t,className:(0,s.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary text-white hover:bg-primary-light focus:ring-primary dark:bg-primary dark:hover:bg-primary-light",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white dark:border-primary dark:text-primary dark:hover:bg-primary dark:hover:text-white",ghost:"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800"}[d],{sm:"px-4 py-2 text-sm 2k:px-5 2k:py-2.5 2k:text-base 4k:px-6 4k:py-3 4k:text-lg",md:"px-6 py-3 text-base 2k:px-7 2k:py-3.5 2k:text-lg 4k:px-9 4k:py-4.5 4k:text-xl",lg:"px-8 py-4 text-lg 2k:px-10 2k:py-5 2k:text-xl 4k:px-12 4k:py-6 4k:text-2xl"}[n],r),disabled:o||l,whileHover:o||l?void 0:{scale:1.02},whileTap:o||l?void 0:{scale:.98},...x,children:l?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"در حال بارگذاری..."})]}):c})});n.displayName="Button"},6196:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var a=r(7437),d=r(2265),s=r(4508);let i=(0,d.forwardRef)((e,t)=>{let{className:r,label:d,error:i,...n}=e;return(0,a.jsxs)("div",{className:"w-full",children:[d&&(0,a.jsx)("label",{className:"block mb-2 text-sm 2k:text-lg 4k:text-xl font-medium text-text dark:text-text-dark",children:d}),(0,a.jsx)("input",{ref:t,className:(0,s.cn)("w-full px-4 py-3 2k:px-6 2k:py-4 4k:px-8 4k:py-5 rounded-lg border border-border dark:border-border-dark","bg-card dark:bg-card-dark text-text dark:text-text-dark","text-base 2k:text-lg 4k:text-xl","focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent","transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed",i&&"border-red-500 focus:ring-red-500",r),...n}),i&&(0,a.jsx)("p",{className:"mt-1 text-sm 2k:text-base 4k:text-lg text-red-500 dark:text-red-400",children:i})]})});i.displayName="Input"},1699:function(e,t,r){"use strict";r.d(t,{T:function(){return i}});var a=r(7437),d=r(2009),s=r(521);function i(){let{theme:e,toggleTheme:t}=(0,d.f)();return(0,a.jsx)("button",{onClick:t,className:"relative p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","aria-label":"تغییر تم",children:(0,a.jsx)(s.E.div,{initial:!1,animate:{rotate:"dark"===e?180:0},transition:{duration:.3},children:"dark"===e?(0,a.jsx)("svg",{className:"w-6 h-6 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):(0,a.jsx)("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})})}},3405:function(e,t,r){"use strict";r.d(t,{x:function(){return n}});var a=r(3464),d=r(7926);let s=r(257).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";class i{setupInterceptors(){this.client.interceptors.request.use(e=>{let{accessToken:t}=d.t.getState();return t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;let{refreshToken:e,logout:t}=d.t.getState();if(e)try{let{access:t}=(await a.Z.post("".concat(s,"/api/kiosk/admin/auth/refresh/"),{refresh:e})).data;return d.t.getState().setAuth(t,e,d.t.getState().user),r.headers&&(r.headers.Authorization="Bearer ".concat(t)),this.client(r)}catch(e){return t(),window.location.href="/admin/login",Promise.reject(e)}else t(),window.location.href="/admin/login"}return Promise.reject(e)})}get instance(){return this.client}constructor(){this.client=a.Z.create({baseURL:s,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}}let n=new i().instance},9693:function(e,t,r){"use strict";r.d(t,{k:function(){return d}});var a=r(3405);let d={createOrder:async e=>(await a.x.post("/api/kiosk/orders/orders/create/",e,{timeout:3e5})).data,getOrderItems:async e=>(await a.x.get("/api/kiosk/orders/order-items/order/".concat(e,"/items/"))).data,reprintReceipt:async e=>(await a.x.post("/api/kiosk/admin/orders/receipt/".concat(e,"/reprint/"))).data}},7926:function(e,t,r){"use strict";r.d(t,{t:function(){return s}});var a=r(9625),d=r(6885);let s=(0,a.Ue)()((0,d.tJ)(e=>({accessToken:null,refreshToken:null,user:null,isAuthenticated:!1,setAuth:(t,r,a)=>e({accessToken:t,refreshToken:r,user:a,isAuthenticated:!0}),logout:()=>e({accessToken:null,refreshToken:null,user:null,isAuthenticated:!1}),updateUser:t=>e({user:t})}),{name:"auth-storage"}))},2009:function(e,t,r){"use strict";r.d(t,{f:function(){return s}});var a=r(9625),d=r(6885);let s=(0,a.Ue)()((0,d.tJ)(e=>({theme:"light",toggleTheme:()=>e(e=>{let t="light"===e.theme?"dark":"light";return document.documentElement.classList.toggle("dark","dark"===t),{theme:t}}),setTheme:t=>{document.documentElement.classList.toggle("dark","dark"===t),e({theme:t})}}),{name:"theme-storage"}))},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s},u:function(){return n},x:function(){return i}});var a=r(1994),d=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,d.m6)((0,a.W)(t))}function i(e){return new Intl.NumberFormat("fa-IR",{style:"currency",currency:"IRR",minimumFractionDigits:0}).format(e)}function n(e){return new Intl.NumberFormat("fa-IR").format(e)}}},function(e){e.O(0,[883,0,954,626,495,839,971,117,744],function(){return e(e.s=1238)}),_N_E=e.O()}]);